Jason Bedford (jrb97) - Problem Set 3
===

Problem 1

Command:

gtfile="/home/rs785/gene760/DATA/PS3/Mus_musculus/UCSC/mm9/Annotation/Genes/genes.gtf"
bindx="/home/rs785/gene760/DATA/PS3/Mus_musculus/UCSC/mm9/Sequence/BowtieIndex/genome"
data-cp1="/home2/ra364/DATA/PS3/CP-1.fastq"
data-cp2="/home2/ra364/DATA/PS3/CP-2.fastq"
data-svz1="/home2/ra364/DATA/PS3/SVZ-IZ-1.fastq" 
data-svz2="/home2/ra364/DATA/PS3/SVZ-IZ-2.fastq"
data-vz1="/home2/ra364/DATA/PS3/VZ-1.fastq"
data-vz2="/home2/ra364/DATA/PS3/VZ-2.fastq"

tophat -p 8 -o ~/scratch/mRNA-runs/out_CP-1 -G $gtfile $bindx $data-*


What is the purpose of the reference annotation? 

The reference annotation file helps to increases the accuracy and sensitivity of the alignment. This is particularly neesary in regions of esons or junctions whihc generally have low coverage resulting in low read overlap. 

What does TopHat use it for?

The purpose of the reference annotation file is explaned in the TopHat manual: 

“..., TopHat will first extract the transcript sequences and use Bowtie to align reads to this virtual transcriptome first. Only the reads that do not fully map to the transcriptome will then be mapped on the genome. The reads that did map on the transcriptome will be converted to genomic mappings (spliced as needed) and merged with the novel mappings and junctions in the final tophat output.”
[source TopHap manual (http://tophat.cbcb.umd.edu/manual.shtml)]

By mapping to the transcriptome first TopHat is able to increase accuracy of fragment alignment. 

---

Problem 2

Commands:

cp1="/home2/jrb97/scratch/mRNA-runs/out_CP-1/accepted_hits.bam"
cp2="/home2/jrb97/scratch/mRNA-runs/out_CP-2/accepted_hits.bam"
svz1="/home2/jrb97/scratch/mRNA-runs/out_SVZ-IZ-1/accepted_hits.bam"
svz2="/home2/jrb97/scratch/mRNA-runs/out_SVZ-IZ-2/accepted_hits.bam"
vz1="/home2/jrb97/scratch/mRNA-runs/out_VZ-1/accepted_hits.bam"
vz2="/home2/jrb97/scratch/mRNA-runs/out_VZ-2/accepted_hits.bam"
CPVZ="/home2/jrb97/scratch/mRNA-runs/CP-VZ"
CPSVZ="/home2/jrb97/scratch/mRNA-runs/CP-SVZ"
VZSVZ="/home2/jrb97/scratch/mRNA-runs/VZ-SVZ"
ALL="/home2/jrb97/scratch/mRNA-runs/CP-VZ-SVZ"
bindx="/home/rs785/gene760/DATA/PS3/Mus_musculus/UCSC/mm9/Sequence/BowtieIndex/genome"
gtfile="/home/rs785/gene760/DATA/PS3/Mus_musculus/UCSC/mm9/Annotation/Genes/genes.gtf"

cuffdiff -p 8 -o $ALL -L CP,VZ,SVZ-IZ $gtfile $cp1,$cp2 $vz1,$vz2 $svz1,$svz2
cuffdiff -p 8 -o $CPVZ -L CP,VZ $gtfile $cp1,$cp2 $vz1,$vz2
cuffdiff -p 8 -o $CPSVZ -L CP,SVZ-IZ $gtfile $cp1,$cp2 $svz1,$svz2
cuffdiff -p 8 -o $VZSVZ -L VZ,SVZ-IZ $gtfile $vz1,$vz2 $svz1,$svz2


What is the difference between RPKM and FPKM?

RPKM ->”RPKM stands for Reads Per Kilobase of transcript per Million mapped reads”
FPKM ->”Fragments Per Kilobase of transcript per Million mapped reads”
[Source: CuffLinks FAQ (http://cufflinks.cbcb.umd.edu/faq.html#fpkm)]


Why is FPKM preferred in paired end sequencing?

The CuffLinks FAQ does an excellent job of answering this question:

“the relative expression of a transcript is proportional to the number of cDNA fragments that originate from it. Paired-end RNA-Seq experiments produce two reads per fragment, but that doesn't necessarily mean that both reads will be mappable. For example, the second read is of poor quality. If we were to count reads rather than fragments, we might double-count some fragments but not others, leading to a skewed expression value. Thus, FPKM is calculated by counting fragments, not reads.”
[Source: CuffLinks FAQ (http://cufflinks.cbcb.umd.edu/faq.html#fpkm)]

Therefore, we see that FPKM is a better metric of relative expression in paired-end RNA-Seq experiments because of the issue of mappability of both ends of a single read. 

---


Problem 3


What is the difference between gene level and isoform level expression values? 

Gene level expression values are derived from sequenced fragments that are mapped to a gene. While isoform level expression values are derived from sequenced fragments that are known to originate from a specific isoform.

When could gene levels expression values be misleading?

Gene levels expression values can be missleading when a gene has multiple isoforms. The reason for this is explaned well by the cufflinks FAQ:

 "... when a gene has multiple isoforms, a change in the total number of reads or fragments from that gene doesn't always correspond to a change in expression for that gene. Conversely, a gene's expression may change, but the total number of fragments generated by its isoforms may be very similar"
[Source: CuffLinks FAQ (http://cufflinks.cbcb.umd.edu/faq.html#cuffdiff)]

The key idea behind this statement is that the amount of a given gene and the amount of a given isoform of that gene are not necessary related in a simple one-to-one manor. 

--


Problem 6

What can you conclude about these cells in terms of relative similarity? Explain your answer.

From the dendrogram plot we see that VZ and SVZ cluster together more closely than to VZ with CP or SVZ with CP. This indicates that VZ and SVZ have more similar isoform specific gene expression. Looking at the heatmap this exact regions of similarity and difference are not apparent. Given that humans are naturally good at finding meaningless patters I don’t think that any biology can be reviled by the heat map plot. 

--




